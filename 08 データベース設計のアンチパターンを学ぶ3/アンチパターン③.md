# 課題 1

## 回答 1

- `belongs_to_id` には Manga.id または Novel.id のどちらかが格納される設計のため、外部キー制約を貼ることができない。
    - Novel を削除した場合に、関連するコメントを同時に消すなどのトリガー制約を付与することができない
- “type”に”MANGA”などタイプミスのレコードが挿入された場合、無効なレコードになってしまう

# 課題 2

## 回答 2

`Books` テーブルを作成し、Books.id と”Manga”,”Novel”,”Comment”に外部キー制約を付与する。

![](attachments/Pasted%20image%2020250413134054.png)

### 新しい設計による改善点

- "type" 列にテーブル名を記載する必要がなくなり、新しいカテゴリーのテーブルが追加された場合の作業量が減少する。
- 外部キー制約が付与されたことで、Books テーブルのレコードを削除した際に、関連する他のテーブルのレコードも自動的に削除できるようになる。

# 課題 3

## 回答 3

別々のシステムで管理していた顧客データを統合する必要が生じた場合

- `LegacySystemData` テーブルを用意し、 `Customers` テーブルに”system_type”カラム（例：systemA/systemB）を追加する。統合前のシステムで管理していた情報については、”system_type”をもとに結合してデータを取得する。